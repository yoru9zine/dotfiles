#!/bin/bash
# emulate stumpwms run-or-raise with ratpoison
# Param1: Windowname to look for
# Param2: Command to start if not present yet
# source: http://lists.gnu.org/archive/html/ratpoison-devel/2010-08/msg00005.html
# source2: https://github.com/ardumont/sh/blob/master/ratpoison/run-or-raise.sh
q="^..$1"
[ $1 == "Chromium" ] && q="${1}$"

NAME=$(ratpoison -c windows|grep "${q}"|head -n 1)
FOUND=$?

[ -z "${NAME}" ] && FOUND=-1
[ $1 != "Chromium" ] && echo $NAME | grep Chromium > /dev/null && FOUND=-1

if [ $FOUND -eq 0 ] ; then
    NAME=$(echo $NAME | cut -b3-)
    # echo "Value grep: $? . selecting"
    ratpoison -c "select ${NAME}"
    exit
fi

# echo "Value grep: $? . starting"
if [ -z "$2" ]; then
    # fallback, we use the same command as the window
    $1&
else
    $2&
fi
